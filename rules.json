{
  "rules": {
    // Uncomment when seeding database
    // ".read": "auth.email === 'broofa@gmail.com'",
    // ".write": "auth.email === 'broofa@gmail.com'",

    "users": {
      "$userId": {
        // User info is visible to the user
        ".read": "$userId === auth.uid",
        ".write": "$userId === auth.uid"
      }
    },

    "attendees":  {
      "$launchId": {
      	".read" : true, 
        "$userId": {
         "role": {
     	     ".write": "$userId === auth.uid" 
          },

					// User may not verify themselves
          // Officers may only change (verify) other users' certs
          ".write": "(
            $userId === auth.uid 
            && !newData.child('cert').child('verifiedTime').exists()
          )
          || (
            $userId !== auth.uid 
            && root.child('officers').child($launchId).child(auth.uid).val() === true
          )",
        }
      }
    },

    "officers":  {
      "$launchId": {
      	".read" : true,
        "$userId": {
            // Disallow `false` values makes it easier to detect "no officers" case
			      ".validate": "newData.val() === true || newData.val() === null",
            // Officer status can only be set by another officer, or if there are no officers
            ".write": "$userId != auth.uid && data.parent().child(auth.uid).val() === true
              || !root.child('officers').child($launchId).exists()"
        }
      }
    },

    "cards":        {
      ".read" : true,
      "$launchId": {
        "$cardId": {
          // Only card owners or officers may change cards
          ".write": "!data.exists()
            || data.child('userId').val() === auth.uid
            || root.child('officers').child($launchId).child(auth.uid).val() === true"
        }
      }
    },

    "launches": {
      ".read" : true,
      "$launchId": {
        // Only officers may edit launch
        ".write": "root.child('officers').child($launchId).child(auth.uid).val() === true"
      }
    },
      
    "pads": {
      ".read" : true,
      "$launchId": {
        // Only officers may edit launch pads
        ".write": "root.child('officers').child($launchId).child(auth.uid).val() === true"
      }
    }
  }
}
